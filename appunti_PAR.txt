Protocolli e Architetture di Rete   
USERNAME: PAR2425
PASSWORD: dieMiephie3b

23/09/24

Rete: può essere definita ricorsivamente --> condivisa
- Due o più nodi connessi tramite collegamenti
- Due o più reti connesse tramite nodi

Componenti fondamentali di una Rete
- NODI
    - Host
        nodo terminale connesso a uno dei capi della comunicazione (mittente, destinatario) --> eterogenei
    - Switch, Bridge, Router...
        nodi intermedi che abilitano la comunicazione tra host
COLLEGAMENTO (LINK)
    - Cablato (Wired): cavi fibra ottica, coassiali, ...
    - Non cablato (Wireless): Wi-fi, Bluetooth, ...

Esempi di rete:
LAN (Local Area Netowrk): Rete locale
WAN (Wide Area Netowrk): Rete geografica

Obiettivo: trasferire un messaggio (insieme di bit) da un host all'altro

PROTOCOLLO
Tutte le comunicazioni sono regolate mediante protocolli
Protocollo: insieme di regole e convenzioni seguite da entità, dislocate su nodi distinti, che intendono comunicare per svolgere un compito comune
Tali regole hanno l'obiettivo di assicurare una cooperazione efficiente ed affidabile per la comunicazione tra nodi tenendo conto
delle caratteristiche tipiche di un sistema distribuito (banda di trasmissione limitata, ritardi variabili, errori nella comunicazione, ...)

- Sintassi: insieme e struttura dei comandi e delle risposte (formato dei messaggi)
- Semantica: significato dei comandi da effettuare al momento della trasmissione e ricezione dei messaggi (contesto corretto)
- Temporizzazione: specifica delle possibili sequenze temporali di emissione dei comandi e messaggi (sequenza temporale ammissibile)

Obiettivi della comunicazione
Trasferimento di un messaggio (insieme di bit) da un host all'altro, garantendo: 
- PRESTAZIONI: massima velocità possibile
- AFFIDABILITA': che si possano superare guasti o malfunzionamenti
- SICUREZZA: la trasmissione deve essere sicura

Stack (o suite) di protocolli: insieme di livelli in cui ogni livello cerca di risolvere in modo indipendente un sottoproblema
Nelle architetture di rete ci sono diversi tipi di funzionalità associate a ruoli diversi

Logica applicativa: implementazione di logiche applicative specializzate (Web, ...)
Comunicazione fra applicazioni: processi in esecuzione sugli host --> Affidabili (ma più lente) - Non affidabili (ma veloci)
Comunicazione fra reti: nodi che risiedono in reti differenti
Comunicazione fra nodi: nodi che risiedono nella medesima rete  

Ciascun protocollo, ad un certo livello, ha due interfacce "interne" (verso il livello superiore ed inferiore) ed una
interfaccia "esterna" verso il livello equivalente di un altro nodo
Le interfacce "interne" si occupano di trasferire i dati da un livello all'altro
L'interfaccia "esterna" rappresenta la richiesta/chiusura della connessione (astratta)

                            Protocollo livello N+1
    Interfaccia "interna"
                            Protocollo livello N    -->    Interfaccia "esterna"
    Interfaccia "interna"
                            Protocollo livello N-1

                            Mezzo fisico (hardware)

La comunicazione avviene logicamente tra protocolli che si trovano allo stesso livello

Slide 40

Communication Unit in Packet Switching: PDU
Ogni pacchetto è costituito da:
    - Protocol Control Information (PCI) --> header
        insieme di metadati necessari al corretto funzionamento del protocollo stesso
    - Service Data Unit (SDU) --> payload
        il vero contenuto informativo scambiato
PCI + SDU = PDU (Protocol Data Unit)
Messaggio: SDU (payload) + PCI (header)

Payload = (payload + header) del livello precedente --> meccanismo di incapsulamento

25/09/24

Nelle comunicazioni informatiche si inviano pacchetti

Standard de iure: creazione di uno standard per legge
Standard de facto: uso comune di un determinato standard non ancora soggetto a norma tecnica

ISO/OSI (de iure): un consorzio ha definito questo standard su carta (International Standard Organization)
TCP/IP (da facto): nato in contesti universitari 

I 7 liveli dello stack ISO/OSI
Application: protocollo applicativo che si vuole utilizzare
Presentation: si occupano di manipolare la rappresentazione delle informazioni in modo da presentarle nel miglior modo possibile (es. responsive)
Session: protocollo che crea uno stato (sessione) tra le applicazioni che eseguono tale protocollo
Transport: protocollo che gestisce la comunicazione tra applicazioni (TCP/UDP)
Network: si occupa di mettere in comunicazione tante reti (IP Address)
Data link: si occupa delle comunicazioni a livello logico locali --> indirizzamento (MAC Address)
Physical: livello che gestisce la trasmissione dell'informazione attraverso un mezzo fisico (cavo, aria, ...)

I 4 livelli dello stack TCP/IP --> stack affermatosi e che studieremo (per il numero del livello si fa riferimento allo stack ISO/OSI)
Application: accorpamento del livello di sessione, presentazione e applicazione (gestiti complessivamente dall'applicazione)
Transport: supporta i trasferimenti da host a host: TCP, UDP
Internet: ipv4-ipv6
Host-to-network: accorpamento del livello fisico e data link --> definisce sia come trasmettere l'informazione a livello fisico che come struttare le informazioni a livello logico (Bluetooth, Wi-Fi)

ISO/OSI
    - cattiva tempistica
    - cattiva tecnologia

FTP  HTTP           IRC  RTP    (Livello 5-6-7)
    |                   |
   TCP                 UDP  (Livello 4)
        |           |
             IP (Livello 3)
        |     |     |
       H2N   H2N   H2N (Livello 1-2)

RTP (Real Time Protocol)
IRC: vecchio protocollo di messaggistica

Switch e bridge sono nodi intermedi di livello 2 - H2N
Router: identifica un nodo intermedio di livello 3 (legge fino all'header IP) 
Switch lv3: switch di livello 2 con eccezioni aggiuntive da leggere un indirizzo ip
Router con funzionalità di natting: router di livello 3 ma con eccezioni aggiuntive per interpretare informazioni di livello 4

Indirizzo ip: sistema di identificazione degli host a livello 3

Modalità di accesso al canale
Multiplexing (condivisione): tecnica che consente di separare un canale fisico in più canali logici, permettendo il passaggio di più segnali in simultaneo sullo stesso mezzo fisico
Demultiplexing: processo che permette di ricostruire le informazioni precedentemente mixate

Metodi basati sulla frequenza (FDM)
Metodi basati sul tempo (TDM)
FDM (Frequency Division Multiplexing): apertura parallela di diversi canali dividendo la banda disponibile
TDM (Time Division Multiplexing): uso alternato di tutta la banda in modo stabilito a priori

Modalità per trasferire i dati
- Circuit Switching (Commutazione a circuito)
    Prevede la creazione di un circuito fisso e dedicato tra due dispositivi prima dell'inizio della comunicazione
    Affidabile ma poco efficiente
- Packet Switching (Commutazione a pacchetto)
    I dati vengono frammentati in pacchetti, ognuno con un'etichetta che contiene l'indirizzo di destinazione
    Questi pacchetti vengono inviati separatamente e possono prendere percorsi diversi per raggiungere la destinazione finale
    Ammette collisioni (interferenze) dovute a condivisione di risorse --> quando due host trasmettono contemporaneamente sullo stesso canale 
        - (Locali) Collisioni nelle reti locali con mezzi fisici condivisi
        - (Reti) Congestione nei buffer di memoria (memorizzano le code dei pacchetti) dei router --> errori o perdite di pacchetti
    Molto efficiente ma ammette collisioni (e congestioni dei buffer)

Metrica di prestazione
Bandwidth (banda di trasmissione): quantità di dati trasmessi per unità di tempo
- Unità di tempo: secondo
- Quantità di dati trasmessi: multipli di bit
    Kbps o Kbit/s --> Kilo-bit per secondo
    Mbps o Mbit/s --> Mega-bit per secondo
    Gbps o Gbit/s  --> Giga-bit per secondo

Livello H2N
- interconnessione tra due o più host
- trasmissione dati tra host direttamente connessi

Esempi:
LAN Wired
- Ethernet (standard de facto)
- Token-ring
- FDDI
- Frame relay

LAN Wireless
- 820.11x

PAN (Personal Area Network)
- Bluetooth
- ZigBee

WAN wireless(Wide Area Network)
- GSM
- UMTS
- LTE
- 4G
- 5G

PREMESSA PER I PROTOCOLLI H2N
Se ho dei collegamenti fisici con una probabilità alta di corruzione (perdita di pacchetto) allora è meglio implementare un protocollo host to network che garantisca l'affidabilità già a livello 1-2 (ritrasmissione) senza dire che poi se ne occuperà il livello 4 (TCP)

30/09/24

Modalità di trasmissione: chi sono i mittenti e i destinatari che vogliono comunicare
    - Unicast: comunicazione fra un singolo mittente e un singolo ricevente --> uno ad uno
    - Multicast: comunicazione fra un singolo mittente e un gruppo di riceventi --> uno a tanti (tutti quanti)
    - Anycast: comunicazione fra un singolo mittente ed almeno un ricevente in un gruppo --> uno a tanti (uno qualsiasi)
    - Broadcast: comunicazione fra un singolo mittente e tutti gli altri nodi --> uno a tutti

Tipi di collegamento (a livello fisico)
Collegamento broadcast / condiviso --> canale fisico broadcast
    - Molti host connessi a uno stesso canale di comunicazione
    - E' necessario un protocollo di accesso al mezzo per coordinare le trasmissioni e per evitare le collisioni (chi può trasmettere?)
    - Sono comuni nelle LAN, WirelessLAN, reti satellitari
Collegamento punto-punto
    - Costituito da un unico trasmittente a un'estremità del collegamento e da un unico ricevente all'altra estremità
    - E' il tipico collegamento fra due router o fra un modem di un accesso residenziale e il router dell'Internet Service Provider (ISP o Provider)

Si possono verificare combinazione di collegamenti --> canale fisico broadcast e collegamento logico unicast
Ethernet è un protocollo pensato per canali fisici di tipo broadcast ma per creare comunicazioni anche Unicast

Collegamenti punto-punto half- e full-duplex
Collegamento Half-Duplex
    - Collegamento che permette solo a un partecipante di comunicare sul mezzo fisico in un istante di tempo
    - Quasi sempre inteso in modo ancora più stringente come comunicazione unidirezionale
Collegamento Full-Duplex
    - Possibilità per il mittente e il destinatario di comunicare in modo indipendente l'uno dall'altro (comunicazione bidirezionale)
    - Ad esempio, collegamento punto-punto con collegamenti interni dedicati per le due direzioni di trasferimento

ATTENZIONE: Attenzione a distinguere le modalità di trasmissione e le caratteristiche del mezzo 

Collegamenti del livello H2N
A livello H2N l'unità di dato trasmesso durante la comunicazione è chiamato FRAME (deriva da Framing, parte di livello fisico del livello H2N)

Adattatori per la comunicazione H2N
- Il protocollo H2N è solitamente implementato all'interno di una scheda adattatrice, conosciuta anche col nome di Network Interface Card o NIC
- Tutti i dispositivi (host, router, altri dispositivi di rete), per poter essere utilizzati in una rete LAN, devono essere dotati di una scheda di rete

Network Interface Card (NIC)
Dispositivo generalmente costituito da una RAM, un DSP (Digital Signal Processor), un'interfaccia bus/host e un'interfaccia di collegamento alla rete
    - Entità semi-autonoma rispetto al sistema in cui risiede, ha un microcontrollore dedicato  
    - Può essere sia integrata sulla scheda madre, oppure presente come dispositivo dedicato
    - (Ethernet) Connettore RJ45

Ethernet --> protocollo inaffidabile (perdita di pacchetti)
Inventata a metà degli anni '70 da Metcalfe che propone Ethernet nella sua tesi di PhD
Il disegno originale prevedeva un solo canale di tipo BUS (canale condiviso broadcast, comunicazione logica di tipo Unicast) per connettere i nodi

LAN Ethernet    
Ethernet è stato pensato in origine per:
    - topologia a bus
    - velocità 1-10Mbps
Attualmente utilizzato:
    - quasi sempre in topologia a stella tramite l'impiego di ulteriori dispositivi di rete (bridge e switch)
    - supporta velocità differenti (anche decine di Gb/s) a seconda dell'HW impiegato

Caratteristiche Ethernet
Tipo di collegamento
    - Usa un Canale Fisico di tipo broadcast (non punto-punto): molti host connessi ad uno stesso canale di comunicazione
    - Quando un host trasmette un pacchetto sulla LAN, TUTTE le interfacce degli host collegati lo ricevono
Modalità di trasmissione
    - Permette comunicazioni Unicast fra host
    - Alcuni messaggi "speciali", necessari per il corretto funzionamento del protocollo, sono di tipo Broadcast

Ethernet
    a. Indirizzi Ethernet: MAC
    b. Frame Ethernet
    c. Protocollo ARP
    d. Accesso al mezzo trasmissivo (Protocollo CSMA/CD)

Indirizzi Ethernet: MAC
- A livello Ethernet, gli host utilizzano un indirizzo hardware o indirizzo MAC (Media Access Control)
- In realtà, l'indirizzo MAC non si riferisce all'host, ma al NIC (Network Interface Card) dell'host
    Ogni NIC ha un indirizzo LAN univoco di 48 bit (6 byte), tipicamente rappresentato da 6 coppie di numeri esadecimali. Es. 81:F4:A3:AA:9C:49
- L'indirizzo broadcast è FF-FF-FF-FF-FF-FF (tutti i bit a 1) --> il destinatario accetterà a prescindere il Frame Ethernet inviatogli da questo indirizzo
- L'indirizzo MAC di un NIC è univoco e permanente:
    - è chiamato anche hardware address perché incorporato nella ROM al momento della fabbricazione
    - univoco in quanto assegnato dai produttori di NIC (Network Interface Card) dell'autorità centrale IEEE
        - tipicamente i primi 3 byte definiscono chi ha prodotto quell'interfaccia di rete (Intel, Apple, Huawei, ...)
        - gli amministratori di rete possono modificare l'indirizzo MAC dell'interfaccia di rete di un host

Frame Ethernet
I pacchetti scambiati a livello H2N vengono detti frame
Indipendentemente dalla topologia, dai mezzi trasmissivi e dalla velocità di trasmissione, tutte le tecnologie Ethernet 
fanno uso dello stesso formato per il frame che trasmettono (Frame Ethernet)

Preambolo (8 byte): identifica la funzionalità di framing, in particolare si occupa della fase di sincronizzazione tra mittente e riceventi
    - i primi 7 byte hanno valore 10101010
    - l'ultimo byte ha valore 10101011
    - i primi 7 byte servono per "attivare" gli adattatori dei riceventi e sincronizzare i loro orologi con quello del mittente
    - i due 1 consecutivi nell'ultimo byte avvisano l'adattatore del ricevente che la fase di sincronizzazione è terminata
Indirizzo destinazione (6 byte): MAC address dell'host di destinazione (filtraggio da parte dell'interfaccia di rete)
Indirizzo sorgente (6 byte): MAC address dell'host sorgente
Tipo (2 byte): implementa una funzionalità di multiplexing (più flussi in un unico canale trasmissivo) per stabilire a quale protocollo del livello superiore inoltrare il payload
    - necessario poichè esistono più protocolli per ciascun livello dello stack TCP/IP
Dati (46 - 1500 byte): payload
CRC (Controllo a Ridondanza Ciclica, 4 byte): permette all'interfaccia che riceve i dati di rilevare la presenza di un errore nei bit del frame ricevuto 
    - il destinatario (o meglio la sua interfaccia di rete) ricalcola il CRC sulla base dei dati ricevuti (dest. address, source address, tipo, payload) e verifica la corrispondenza con quello ricevuto

Modalità promiscua: modalità dell'interfaccia di rete che permette di non filtrare i pacchetti a seconda dell'indirizzo di destinazione 
    - in caso di non corrispondenza dell'indirizzo di destinazione il pacchetto viene comunque accettato e non scartato

Protocollo ARP (Address Resolution Protocol) --> Sottoprotocollo (del livello H2N) del protocollo Ethernet
L'Address Resolution Protocol (ARP) si occupa di individuare l'indirizzo MAC di un host della stessa LAN di cui conosce l'indirizzo IP (risolve l'associazione Indirizzo IP - MAC Address)
Il protocollo ARP è incluso nella suite di protocolli TCP/IP

Funzionamento
Utilizza due tipi di messaggi ARP:
    - richiesta (ARP-Request) contenente l'indirizzo IP del destinatario (Will 128.213.1.5 please send me his Ethernet address?)
    - risposta (ARP-Reply) contenente il corrispondente indirizzo MAC (I'm 128.213.1.5, and my Ethernet address is 87:A2:15:35:02:C3)
ARP utilizza il broadcast della richiesta --> la richiesta viene inoltrata a TUTTI

ARP Request --> Broadcast
ARP Reply --> Unicast

02/10/24

Un'ARP Request può anche essere Unicast, si ha quando un host vuole assicurarsi che il MAC Address di quel determinato host corrisponda con la entry presente nella propria ARP Table
    --> verifica consistenza della cache locale

ARP Table: cache locale temporanea che contiene le associazioni indirizzo IP - MAC address

Esistono anche cache statiche configurate in modo permanente per questioni di sicurezza (spoofing) 
    - inserire manualmente delle entry permanenti nella tabella ARP
    - disattivare completamente il protocollo ARP

Migliorare le prestazioni di ARP
- Cache ARP: per ridurre il traffico sulla rete causato dallo scambio di messaggi ARP:
    - ciascun host effettua un caching temporaneo delle risoluzioni IP/MAC nella sua tabella di instradamento
    - il mittente inserisce nella richiesta la corrispondenza fra il proprio indirizzo IP e quello MAC

Flusso di funzionamento del protocollo Ethernet
- Se l'input è l'indirizzo IP (come solito):
    1. Controllare se IP si trova in tabella ARP locale
    2. Se assente o TTL scaduto, eseguire protocollo ARP per ottenere MAC address destinatario
        - Se scade timeout, assumo che il destinatario non sia presente nella rete Ethernet (non c'è una risposta esplicita negativa)
    3. Uso il MAC address ottenuto nel payload della risposta ARP come MAC address destinazione dei frame da inviare nella comunicazione
        - Periodicamente, il sistema esegue ARP per verificare la corrispondenza IP-MAC

Protocollo RARP (deprecato)
- Reverse Address Resolution Protocol
- Funzione opposta al protocollo ARP --> Dato un indirizzo MAC, ricava l'indirizzo IP corrispondente
- Meccanismo analogo ad ARP
    - Broadcast di una richiesta
    - Solo l'host interessato risponde (in questo caso, il server RARP)
    - Struttura dei messaggi analoga a quella del protocollo ARP

Accesso al mezzo trasmissivo (CSMA/CD) --> protocollo strettamente legato al livello fisico di Ethernet
Protocollo di accesso multiplo
- I frame Ethernet vengono trasmessi dagli host collegati allo stesso segmento di LAN su un canale condiviso (bus) broadcast a bit rate elevato
(modalità di accesso multiplo)
- La spedizione contemporanea di più frame causa rischi di collisione
- E' necessario un protocollo di accesso al mezzo per coordinare le trasmissioni sul canale condiviso e evitare, se possibile, collisioni e
gestirle nel caso in cui non sia stato possibile evitarle

Protocollo CSMA/CD (Carrier Sense Multiple Access Collision Detection)
- Protocollo completamente decentralizzato --> non esiste un'entità centrale a gestire i nodi della rete
- Quando un host deve trasmettere, "ascolta" il canale (carrier sense)
- Quando un host trasmette, lo fa alla massima velocità consentita dal canale
- Quando un host rileva una collisione, ritrasmette il frame fino a quando la trasmissione non ha successo
- La ritrasmissione non è immediata, ma l'host attende un periodo di tempo calcolato in modo pseudo-casuale

Carrier sense (rilevazione della portante sul canale)
    - ogni host che deve trasmettere ascolta il bus e decide di trasmettere solo se lo trova libero ("listen before talking")

Multiple Access (accessi multipli)
    - Nonostante la funzione di carrier sense, essendo un protocollo decentralizzato, due host potrebbero decidere di trasmettere in contemporanea
    - Essendo il tempo di propagazione del segnale sulla rete non nullo, un host può presumere che il mezzo sia libero
     anche se un altro ha già iniziato a trasmettere

Collision Detection (rilevamento della collisione)
    - Se si verifica una sovrapposizione di trasmissioni si ha una collisione
    - Per rilevare una collisione, ogni host mentre trasmette ascolta i segnali sul mezzo, confrontandoli con quelli da
    esso generati ("listen while talking")
    - Se viene rilevata una collisione, l'host interrompe la trasmissione

CSMA/CD: collisioni
A seguito di una collisione:
- Ogni host sospende la trasmissione e trasmette un segnale di JAMMING (disturbo) per avvisare tutti gli host della collisione 
- Il segnale di JAMMING assicura che ogni host rilevi la collisione anche nel caso in cui la collisione sia stata di breve durata
- Gli host trasmittenti ripetono il tentativo di trasmissione dopo un ritardo (pseudo-)casuale, determinato mediante
    un "algoritmo di exponential back-off", che ha il compito disaccoppiare i tentativi di ritrasmissione, fino a un massimo di 16 ritrasmissioni

Binary Exponential Back-off (BEB) --> logica probabilistica (output differente indipendente dagli input), non deterministica
- Il ritardo è K x 512 intervalli di tempo (tempo necessario per trasmettere un bit), dove K dipende dal numero di collisioni già rilevate
- Algoritmo di exponential back-off --> la cardinalità dell'insieme da cui è scelto K cresce esponenzialmente col numero delle collisioni
    - K ← [0, 2^n -1] --> n = numero di collisioni già rilevate
- Ethernet usa un approccio "calmierato" quando n = 10
    - 1a collisione: scegli K tra {0,1};
    - n-esima collisione: scegli K tra {0, 1, …, 2^m -1 }
        (dove m=min{n,10})
    - Da 10a collisione a 15a : scegli K tra {0, …, 1023}
    - 16a collisione: RINUNCIA

BEB: attesa esponenziale
• Scopo: si cerca di stimare il livello di carico della rete per adattare i successivi tentativi di ritrasmissione
• Tramite l'incremento esponenziale delle dimensioni dell'insieme dei valori tra cui si sceglie il ritardo di attesa K,
    l'host riesce ad adattare la ritrasmissione alle diverse situazioni di traffico:
    • Basso ritardo quando pochi host collidono
    • Ritardo di attesa maggiore in presenza di sovraccarico

Dati (e dimensione)
L'unità massima trasferibile (MTU - Maximum Transfer Unit) per Ethernet è 1500 byte
    - Se i dati superano i 1500 byte, devono essere frammentati (si vedrà in seguito)
La dimensione minima del campo dati è 46 byte
    - Se la dimensione dei dati è inferiore a 46 byte, il campo dati deve essere "completato" (byte di stuffing) fino a 46 byte con byte di riempimento
     (che verranno rimossi all'atto della ricezione)

NB: L'MTU limita la dimensione massima dei pacchetti anche dei livelli superiori dello stack TCP/IP

Architetture LAN Ethernet

Rete LAN 
- Una Local Area Network (LAN) è una rete in cui i nodi possono comunicare fra di loro tramite protocollo di livello H2N
- Il nome deriva dell'estensione della rete, limitata sia nelle distanze fra i nodi sia nel numero di nodi collegati

Back-end LAN + Backbone LAN
- Le LAN che costituiscono gli elementi fondamentali di accesso a Internet sono dette back-end LAN
    e possono essere collegate mediante backbone LAN
- Le back-end LAN realizzano sistemi (dipartimentali) di medie dimensioni, interconnettendo server, dispositivi di
    storage, PC, ecc., con le seguenti caratteristiche:
        – Media-alta capacità di traffico (tipicamente 1 Gps)
        – Accessi distribuiti
        – Distanza limitata tra i componenti
        – Costi ridotti
- Le backbone LAN servono per interconnettere diverse back-end LAN e devono garantire:
    – Affidabilità
    – Elevata capacità di traffico (tipicamente, >1 Gbps, esistono LAN per data center fino a 100 Gbps)

Topolgie per LAN
A seconda dei contesti e dei protocolli impiegati, possiamo individuare diverse topologie di LAN:
    • Albero 
    • Bus --> massima economicità - minime performance
    • Anello -->trade off tra soluzione a bus e altre
    • Stella

Topologia a bus
- È il metodo più semplice di connettere in rete degli host (schema originale di Ethernet)
    Consiste di un singolo cavo (chiamato dorsale o segmento) che connette in modo lineare tutti gli host
I messaggi sono inviati a tutti gli host come segnali elettrici e vengono accettati solo dal NIC dell'host il cui
    indirizzo MAC è contenuto nel segnale di origine
In ciascuna estremità è presente un Terminatore che assorbe i dati liberi rendendo nuovamente disponibile il cavo

Topologia ad anello
- Gli host sono connessi tramite un unico cavo circolare privo di terminatori
- I segnali sono inviati lungo il circuito chiuso passando attraverso ciascun host che funge da ripetitore e
    ritrasmette il segnale (se non è il mittente)

Topologia a stella
- Gli host sono connessi a un dispositivo di rete centrale (centro stella):
    i messaggi da qualunque mittente a qualunque destinatario sono inviati attraverso tale componente
La quasi totalità delle reti Ethernet moderne sono progettate con topologia a stella
- Nel caso di interruzione di uno dei cavi di connessione di un host al dispositivo centrale, solo quell'host verrà isolato dalla rete
    Non c'è single point of failure a livello di rete
- In caso di mancato funzionamento del componente centrale saranno interrotte tutte le attività di rete
    C'è single point of failure a livello di dispositivo

Topologia ad albero

Tipi di dispositivi di rete
- Hub (repeater) --> centro stella di livello 1
- Switch --> centro stella di livello 2
- Bridge --> centro stella di livello 2
    In alcuni contesti, si parla anche di Bridge e Switch di livello 3, ovvero in grado di leggere anche alcune informazioni del protocollo di rete

Hub
Dispositivo di livello fisico dotato di due o più interfacce
Essenzialmente, è un ripetitore che opera a livello di singoli bit (livello 1 – fisico):
    --> inoltra i bit ricevuti su una interfaccia a tutte le altre interfacce (rete condivisa, stesse performance della rete a bus)
Ogni nodo connesso fa parte dello stesso segmento di LAN

Switch --> autoconfigurante (assegna le interfacce agli host leggendo gli indirizzi MAC sorgenti durante una comunicazione tra due host)
Sono dispositivi fisici che implementano funzionalità di inoltro selettivo dei frame e offrono alte prestazioni
    – Inoltro (selettivo) di frame a livello 2 --> inoltra il frame Ethernet soltanto all'host di destinazione (leggendo il suo MAC)
    – Filtraggio utilizzando indirizzi MAC
Tipicamente, lo switch è un dispositivo con molte interfacce di rete ed è usato come centro stella
Quando un frame deve essere inoltrato su un segmento di LAN, il bridge usa il protocollo CSMA/CD per trasmettere

Metodi di filtraggio e inoltro
Gli switch imparano quali host possono essere raggiunti attraverso quali interfacce (autoconfigurante)
    – Mantengono delle tabelle di filtraggio (Hash Table) costruite automaticamente senza bisogno dell'intervento di amministratori di rete
    – Quando viene ricevuto un frame, lo switch "impara" la locazione del mittente
    – Registra la locazione del mittente nella tabella di filtraggio
Record per la tabella di filtraggio:
    – Indirizzo MAC dell'host, Interfaccia dello switch, Time-To-Live (TTL) --> tempo massimo per cui vale una certa informazione
            che è il periodo di validità delle informazioni memorizzate nella tabella di filtraggio
    – Record vecchi nella tabella di filtraggio vengono scartati (TTL più o meno configurabile a seconda dello switch)

07/10/24

Lo switch crea un mapping tra numero di porta (o interfaccia) e indirizzo MAC

Cavi incrociati (crossover): connessioni fra dispositivi di rete dello stesso livello dello stack TCP/IP (es. switch-switch, host-host)
Cavi dritti (straight): connessioni fra dispositivi di livello differente (es. switch-host)

Hub
● Un hub è un dispositivo di rete che permette di connettere due o più host o dispositivi di rete
● A differenza degli switch, non utilizza regole di inoltro. Invia tutti i dati ricevuti da ogni porta su tutte le altre porte

Bridge
● Un bridge è un dispositivo di rete che permette di unire due segmenti di rete
    - Si uniscono i domini di broadcast Ethernet
    - Non riguarda il livello IP (ovvero, non avviene routing)
● Dispositivo di rete di livello 2
    - Si uniscono i domini di broadcast
    - I domini di collisione rimangono separati
● Da questo punto di vista sono bridge anche gli switch

Laboratorio

help --> visualizza i comandi eseguibili sul terminale proprietario dello switch
hash/print --> mostra il contenuto della Hash Table
hash/setsize --> resize la Hash Table
hash/setexpire --> permette di modificare il TTL

HOST M1
nano /etc/network/interfaces --> file che permette di creare le varie configurazioni di rete persistenti (letto a tempo di boot dal sistema)

auto eth0 --> il sistema capisce che l'amministratore vuole attivare l'interfaccia 0 a tempo di boot

iface eth0 inet static --> direttiva per la configurazione dell'interfaccia 0 in modo statico (manuale)
    address 192.168.0.1/24  --> assegnazione indirizzo ip

HOST M2
nano /etc/network/interfaces

auto eth0

iface eth0 inet static
    address 192.168.0.2/24

ifup eth0 --> attiva l'interfaccia specificata (si utilizza una volta configurato il file interfaces)
ifdown eth0 --> disattiva l'interfaccia specificata
ifconfig eth0 --> mostra la configurazione a runtime dell'interfaccia specificata

HOST M3
ifconfig eth0 up --> attiva l'interfaccia specificata senza assegnare un indirizzo ip
tcpdump -eni eth0 --> per ascoltare il traffico di rete in una determinata interfaccia

SWITCH S1
hash/showinfo --> parametri attuali di configurazione dello switch

ip neigh flush all --> cancellazione dell'arp table

tmux  --> software che permette di aprire più terminali in un uno solo (Terminal Multiplexer)
Modalità comandi --> CTRL-B
    " --> split orizzontale
    % --> split verticale 
    c --> nuovo tab
    d --> detach (distacca la sessione esistente) 
    tmux attach --> riapre il tab detachato
    logout / CTRL-D --> per uscire dal terminale
    frecce direzionali --> per muoversi fra split
    numero del tab [0-9] --> per muoversi fra tab

arping 192.168.0.2 --> testa una comunicazione attraverso il protocollo ARP (manda in continuazione delle richeste ARP)
    - bypassa l'ARP Table
    - funziona solo in rete locale
    - richiede i permessi di amministratore

dmesg --> attiva/disattiva la modalità promiscua dell'interfaccia (visualizza i messaggi del kernel)

arping -0i eth0 192.168.0.1 --> testa le comunicazioni anche senza aver assegnato l'ip del mittente e la sua relativa interfaccia
    - a differenza del comando ping che necessita la configurazione dell'ip nel mittente

bridge: funzionalità svolta da un nodo tramite una logica software che esegue lo stesso ruolo di inoltraggio dello switch
    - può inoltrare anche pacchetti da una rete ethernet a una rete Wi-Fi

Configurazione di un bridge 
brctl addbr br0 --> creazione di un bridge (astratto)
brctl show br0 --> mostra le informazioni del bridge specificato
brctl addif br0 eth0 --> aggiunge l'interfaccia specificata al bridge
ifconfig eth0 up --> attiva l'interfaccia specificata
ifconfig eth1 up --> attiva l'interfaccia specificata
ifconfig br0 up --> attiva l'interfaccia virtuale per la funzionalità di bridging sul nodo
ifconfig br0 192.168.0.4/24 --> è possibile assegnare un indirizzo ip al bridge (se svolto, non vanno configurati gli ip nelle altre interfacce)

Configurazione persistente del bridge
BRIDGE
nano /etc/network/interfaces

auto br0

iface br0 inet static
    bridge_ports eth0 eth1
    address 0.0.0.0 --> indirizzo speciale (nessun indirizzo assegnato)

09/10/24

Vantaggi dello switch
- Isola i domini di collisione producendo un aumento del massimo traffico totale gestibile,
e non limita il numero degli host, né la copertura geografica
- Può connettere tipi diversi di Ethernet (dal punto di vista fisico) dal momento che è un dispositivo "store-and-forward"
    --> prima di inoltrare c'è l'immagazzinamento completo del pacchetto

Tipi di commutazione per switch
• Switch con commutazione store-and-forward
    Quando un frame è instradato attraverso un commutatore store-and-forward, è raccolto e immagazzinato nella sua totalità prima
    che il commutatore inizi a trasmetterlo sulla linea di uscita
• Switch con commutazione cut-through (utilizzati solo per alte performance)
    Il frame è inoltrato dalla porta di input dello switch a quella di output senza aspettare che tutto il frame sia arrivato al commutatore
    E' sufficiente che sia giunta la parte del frame contenente l'indirizzo di destinazione e che il canale di uscita sia libero
    PRO: miglioramento delle prestazioni
    CONTRO: possibile inoltro di frame "difettosi" --> non viene controllato il byte di controllo

Bridge/Bridging
Dispositivo di livello 2 (link layer)
    • Esamina l'header dei frame e li inoltrano "selettivamente" sulla base dell'indirizzo MAC della loro destinazione
    • Analogo allo switch, ma può supportare più mezzi fisici
    • Due tipologie di bridging:
        • Bridging trasparente: collega due tecnologie fisiche che impiegano lo stesso sistema di indirizzamento di LV2 (collegare due reti senza l'utilizzo del livello 3)
        • Bridging non trasparente: il bridge implementa logiche per “convertire” i protocolli di LV2, compresi indirizzi HW (poco utilizzato)
Il sistema operativo può implementare una logica di bridging per emulare uno switch

Lo switch può essere considerato un tipo particolare di bridge trasparente fornito di un alto numero di porte
    • Analizza il livello 2 dei frame e separa i domini di collisione, ovvero separa nettamente i due mezzi fisici
    • Può supportare collegamenti fisici a velocità di trasferimento diverse

Limiti (generali) di Ethernet
- Massima distanza fra due host in un dominio di collisione
- Per questo si utilizzano approcci multi-livello (gerarchici) che collegano diversi switch fra di loro --> rete ad albero
- Queste caratteristiche limitano sia il massimo numero di host collegabili, sia il raggio di azione geografico di una LAN
Soluzione --> switch in cascata
    Svantaggio: i messaggi broadcast (ARP Request) vengono indirizzati a tutti gli host della rete

Topologie soggette a single point of failure
- Nel caso di caduta di un ramo della rete, ciò compromette una gran parte della rete --> single point of failure
- Per aumentare l'affidabilità di una rete, è necessario avere "ridondanza" ovvero "cammini alternativi" dalla sorgente alla destinazione

Problemi della ridondanza
Tuttavia, avendo cammini multipli possono crearsi cicli (provocano un collasso della rete) e conseguentemente gli switch potrebbero moltiplicare i frame
    Soluzione --> spanning tree (albero di copertura completo senza cicli) riconfigurabile automaticamente

Spanning Tree Protocol (STP)
Protocollo che permette, in caso di configirazione ethernet ridondata, di disabilitare selettivamente alcune porte dello switch o bridge per eliminare i loop
Definito nello standard IEEE 802.1D (ente che standardizza molteplici protocolli di telecomunicazioni, ecc...)
• Permette di individuare link ridondanti in modo automatico e dinamico
• Per funzionare, deve essere supportato ed attivato su tutti gli switch della rete locale interessata
• Si basa sulla generazione di traffico aggiuntivo da parte degli switch
    • Bridge Protocol Data Units (BPDUs)
• Si basa sull'identificazione di un Root bridge (o Root switch)
• Utilizza una logica di prioritizzazione tramite l'assegnazione di un identificativo (bridge priority) ad ogni switch
• Lo switch con il valore minore è il Root switch --> maggiore priorità
• L'obiettivo del protocollo è mantenere attive solo le porte che permettono a ciascuno switch di comunicare con il root switch con il costo minore
--> BASSA OTTIMIZZAZIONE DEI COSTI (la ridondanza creata non provoca un aumento delle performance)

Perchè non creare Internet come un'unica grande rete Ethernet?
    - Sarebbe possibile supportare una quantità limitata di traffico: su una singola LAN, tutti gli host devono condividere la stessa larghezza di banda
    - Ci sarebbe un unico grande dominio di broadcast

Cablaggio strutturato: set di normative che standardizzano come noi dovremmo tracciare fisicamente delle reti fisiche
    - Dorsale di comprensorio
    - Dorsale di edificio
    - Armadio di edificio
    - Cavo di distribuzione di piano
    - Armadio di piano
    - Presa utente

IP (Internet Protocol)
Descritto nell'RFC (Request For Comment) 791, pubblicato dalla IETF (organizzazione legata agli standard di Internet) nel settembre 1981
Internet: è una rete globale con un insieme di nodi e reti dotati e identificati attraverso indirizzi univoci
- Obiettivo globale:
    Connettere un qualsiasi numero di reti (scalabilità) eterogenee (distinzione netta fra H2N e Network) e indipendenti (alta decentralizzazione organizzativa)
- Scelte fondamentali del progetto:
    - Comunicazioni con paradigma "packet switching"
    - Nodi intermedi ("router") che inoltrano i pacchetti con "intelligenza minima" (minore complessità = minori costi e maggiori performance)
        - Logica di inoltro "stateless" --> ogni router inoltra i pacchetti soltanto sulla base del contenuto del pacchetto stesso
        - Intelligenza delegata agli host (ai layer trasporto e applicativo, se necessaria)

Nodi terminali --> Host
Nodi intermedi --> Router

Ogni nodo ha almeno un indirizzo ip univoco

I nodi sono "aggregati" in reti, identificabili a loro volta da "blocchi di indirizzo"
    --> logica di indirizzamento gerarchico

Internet è un insieme di reti e host --> aspetto tecnico
Internet è un insieme di reti gestite da organizzazione differenti (Autonomous Systems = ISP) --> aspetto organizzativo

Aspetto "Fisico"
    Un insieme di nodi e reti dotati di indirizzi univoci
Aspetto "Funzionale"    
    Rete globale organizzata in tante sotto-reti tramite un sistema di indirizzamento gerarchico,
    l'inoltro avviene mediante packet switching e inoltro stateless dei pacchetti, per ottenere massime prestazioni dai router
Aspetto "Organizzativo"
    Un insieme di organizzazioni e aziende (Autonomous Systems - AS), che amministrano in modo esclusivo e decentralizzato
    "porzioni di Internet" e collaborano per mantenere la rete globale e garantire un accesso "neutrale" agli utilizzatori

Principi funzionali del protocollo IP
- Survivability (sopravvivenza)
    Se tra due host esiste un qualsiasi percorso, la comunicazione deve poter avvenire (massima affidabilità)
- Forma a clessidra su più livelli
    IP effettua minime assunzioni sui mezzi di trasporto sottostanti e deve funzionare per tutti i tipi di applicazioni di rete
- Mancanza di "stato"
    Non mantiene alcuna informazione sullo stato delle connessioni attive 
    Il router tratta ogni pacchetto di dati in modo indipendente, senza considerare comunicazioni precedenti
    - Net neutrality
    Ogni pacchetto con qualsiasi mittente e destinazione è trattato nello stesso modo
- Decentralizzazione organizzativa
    Ogni rete è potenzialmente posseduta e gestita da un ente diverso (AS)

Funzioni del livello 3 Netowrk
1. Si garantisce l’indirizzamento univoco degli host
    - Tutti gli host collegati a Internet devono essere identificati ed in modo esclusivo  Indirizzo IP
2. Si definisce l'unità di trasferimento dati
    - Definisce l'unità informativa utilizzata da Internet per trasferire dati --> Datagram IP
3. Si chiarisce l'architettura di Internet
    - Definisce i componenti fondamentali di una rete distribuita su scala geografica --> Autonomous Systems, Router
4. Si illustrano le diverse funzioni di routing
    - Gli algoritmi di routing determinano il percorso nell'ambito di una rete geografica attraverso il quale si consegnano i datagram
    - Caratteristica best-effort: la consegna dei datagram è non affidabile

Indirizzi IP (IPv4)
Un indirizzo IP ha dimensione 32 bit, ed è solitamente rappresentato tramite i valori di ciascuno dei 4 byte che lo compongono in notazione decimale
    Esempio: 155.185.121.7

Spazio di indirizzamento
    - Gerarchico (strutturato, logica a valenza
     posizionale)

Indirizzi IP
- Per fornire un servizio di comunicazione universale occorre un metodo che permetta di identificare univocamente ogni nodo
- L'indirizzo IP (32 bit) è suddiviso in 4 campi:
    - Ciascun campo è formato da un byte (8 bit)
    - E' separato da un punto (notazione decimale puntata o dotted notation)
    - Esempio: 130.192.5.189

Componenti dell'indirizzo IP
Ogni indirizzo IP è solitamente strutturato in una coppia:
    <netid, hostid>
    - "netid" (o prefisso di rete) identifica la rete
    - "hostid" identifica un host di quella rete
Questa notazione consente di indicare sinteticamente intervalli contigui di indirizzi

Assegnazione di indirizzi IP
- Ogni rete gestisce in modo esclusivo tutti gli indirizzi IP sottintesi dal NetId assegnato
- L'approccio è ricorsivo (consistente con la definizione di rete)
    - Un blocco di indirizzi può essere assegnato a una rete locale in cui tutti gli indirizzi possono comunicare a livello H2N
    - Oppure essere assegnato a una rete «logica» che contiene più reti («logiche» o locali)
        - In questo caso si parla di subnetting (approfondimenti dopo)

Classi di indirizzi ip
3 classi utilizzabili per l’indirizzamento di host (classe A, classe B, classe C), più 1 classe per multicast address (classe D), più 1 classe riservata (classe E)
    - La quantità di bit destinati al prefisso di rete dipende dalla classe cui l'indirizzo appartiene

• Classe A (7 bit per netid, 24 bit per hostid)
    - 128 (2 ) possibili network ID
    - Oltre 16 milioni di host ID per ciascun network ID
• Classe B (14 bit per netid, 16 bit per hostid)
    - 16K =16384 (2 ) possibili network ID
    - 64K = 65536 (2 ) host ID
• Classe C (21 bit per netid, 8 bit per hostid)
    - Oltre 2 milioni (2 ) di possibili network ID
    - 256 (2^ ) host ID

Indirizzi classless
Oggi gli indirizzi non sono considerati in classi fisse, ma l'intero spazio di indirizzamento può essere suddiviso in blocchi di dimensioni differenti
Si usa la notazione CIDR (Classless InterDomain Routing) dove ciascun insieme di bit del netid è indicato dal suffisso n nella notazione
    a.b.c.d/n